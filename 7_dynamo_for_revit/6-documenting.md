# Выпуск документации

Параметры выпуска документации редактируются по тому же принципу, что и в предыдущих разделах. В этом разделе мы рассмотрим редактирование параметров, которые не влияют на геометрические свойства элементов, но необходимы для подготовки файла Revit к выпуску документации.

### Отклонение

В упражнении ниже, чтобы создать лист Revit для документации, будет использоваться стандартный узел Deviation from Plane (отклонение от плоскости). Каждая панель в конструкции крыши, определенной параметрически, имеет собственное значение отклонения. Необходимо указать диапазон значений, используя цвет и составив спецификацию адаптивных точек, для передачи консультанту, инженеру или подрядчику, работающему с фасадом.

![отклонение](images/6/deviation.jpg)

> Узел Deviation from Plane вычисляет расстояние, на которое набор из четырех точек отклоняется относительно оптимально вписанной между ними плоскости. Это простой и быстрый способ проверки технологичности конструкции.

## Упражнение

### Часть I. Задание коэффициента апертуры панелей на основе отклонения от узла плоскости

> Скачайте файл примера, щелкнув указанную ниже ссылку.
>
> Полный список файлов примеров можно найти в приложении.

{% file src="datasets/6/Revit-Documenting.zip" %}

Начнем с открытия файла Revit для данного раздела (также можно продолжить работу с файлом из предыдущего раздела). В этом файле представлен массив панелей ETFE на крыше. Эти панели будут использоваться в данном упражнении.

\![](<images/6/documenting - exercise I - 01.jpg>)

> 1. Добавьте узел _Family Types_ в рабочую область и выберите _ROOF-PANEL-4PT_.
> 2. Соедините этот узел с портом ввода узла _All Elements of Family Type_, чтобы перенести все элементы из Revit в Dynamo.

\![](<images/6/documenting - exercise I - 02.jpg>)

> 1. Запросите местоположение адаптивных точек каждого элемента с помощью узла _AdaptiveComponent.Locations_.
> 2. Создайте полигон по этим четырем точкам с помощью узла _Polygon.ByPoints_. Обратите внимание, что в Dynamo используется абстрактная версия системы панелей (без необходимости импорта всей геометрии элемента Revit).
> 3. Вычислите отклонение от плоскости с помощью узла _Polygon.PlaneDeviation_.

Просто в качестве дополнения, как и в предыдущем упражнении, укажите коэффициент апертуры каждой панели на основе отклонения от плоскости.

\![](<images/6/documenting - exercise I - 03.jpg>)

> 1. Добавьте узел _Element.SetParameterByName_ в активное окно и соедините адаптивные компоненты с портом ввода _element_. Соедините узел _Code Block_, содержащий строку _Aperture Ratio_, с портом ввода _parameterName_.
> 2. Напрямую соединить результаты отклонения с портом ввода value невозможно, так как необходимо перенастроить значения на другой диапазон параметров.

\![](<images/6/documenting - exercise I - 04.jpg>)

> 1. С помощью узла _Math.RemapRange_ перенастройте значения отклонения на область между 0,15 и 0,45 путем ввода `0.15; 0.45;` в узле _Code Block_.
> 2. Соедините эти результаты с портом ввода value узла _Element.SetParameterByName_.

Вернувшись в Revit, можно _примерно_ оценить изменение в апертуре на поверхности.

![Упражнение](../.gitbook/assets/13.jpg)

При увеличении масштаба становится понятно, что вес замкнутых панелей направлен к углам поверхности. Незамкнутые углы направлены вверх. Углы представляют собой участки более значительных отклонений, в то время как выпуклость имеет минимальную кривизну, так что все логично.

![Упражнение](../.gitbook/assets/13a.jpg)

### Часть II. Цвет и документация

Указание коэффициента апертуры не дает четкой картины отклонения панелей на крыше. Кроме того, изменяется геометрия самого элемента. Предположим, нужно просто изучить отклонение с точки зрения технической осуществимости изготовления. Для этого в документации можно окрасить панели в различные цвета в зависимости от диапазона отклонений. Это можно сделать при помощи следующих шагов, которые очень похожи на действия, описанные выше.

\![](<images/6/documenting - exercise II - 01.jpg>)

> 1. Удалите узел _Element.SetParameterByName_ и узлы, соединенные с его портами ввода, а затем добавьте узел _Element.OverrideColorInView_.
> 2. Добавьте узел _Color Range_ в рабочую область и соедините его с портом ввода color узла _Element.OverrideColorInView_. Для создания градиента необходимо также соединить значения отклонения с цветовым диапазоном.
> 3. При наведении указателя на порт ввода _value_ видно, что значения для этого порта должны быть в диапазоне от _0_ до _1_. Только в этом случае можно будет сопоставить цвета со значениями. Необходимо перенастроить значения отклонения, задав этот диапазон.

\![](<images/6/documenting - exercise II - 02.jpg>)

> 1. С помощью узла _Math.RemapRange_ перенастройте значения отклонения от плоскости, задав диапазон от *0* до _1_. (Примечание. Чтобы задать исходную область, также можно использовать узел _MapTo_.)
> 2. Соедините результаты с портом ввода узла _Color Range_.
> 3. Обратите внимание, что в результате получается диапазон цветов, а не диапазон чисел.
> 4. Если используется режим «Вручную», нажмите кнопку _Запуск_. С этого момента вы, скорее всего, сможете без проблем работать в автоматическом режиме.

Вернувшись в Revit, видим значительно более наглядный градиент, характеризующий отклонение от плоскости на основе цветового диапазона. Но что, если требуется изменить цвета? Обратите внимание, что минимальные значения отклонения обозначены красным цветом, что не вполне логично. Необходимо, чтобы максимальному отклонению соответствовал красный, а минимальному — более спокойный цвет. Вернемся в Dynamo и устраним этот недостаток.

![](../.gitbook/assets/09.jpg)

\![](<images/6/documenting - exercise II - 04.jpg>)

> 1. Используя узел _Code Block_, добавьте два числа в две разные строки: `0;` и `255;`.
> 2. Создайте красный и синий цвета, соединив соответствующие значения с двумя узлами _Color.ByARGB_.
> 3. Создайте список из этих двух цветов.
> 4. Соедините этот список с портом ввода _colors_ узла _Color Range_ и посмотрите, как при этом изменится пользовательский цветовой диапазон.

Теперь, вернувшись в Revit, можно получить более наглядное представление об областях максимального отклонения в углах. Помните, что этот узел служит для переопределения цвета на виде, поэтому он может быть очень полезен в случае, когда в наборе чертежей есть лист, предназначенный для определенного типа расчета.

\![Exercise](<../.gitbook/assets/07 (6).jpg>)

### Часть III. Создание спецификаций

При выборе в Revit одной панели ETFE отображаются четыре параметра экземпляра: XYZ1, XYZ2, XYZ3 и XYZ4. После создания все они будут пустыми. Это текстовые параметры, для которых требуется задать значения. С помощью Dynamo создадим местоположения адаптивных точек для каждого параметра. Это способствует взаимодействию в случаях, когда геометрический объект необходимо отправить инженеру или консультанту по фасадам.

\![](<images/6/documenting - exercise III - 01.jpg>)

На образце листа представлена большая пустая спецификация. Параметры XYZ являются общедоступными параметрами в файле Revit, благодаря чему их можно добавить в спецификацию.

\![Exercise](<../.gitbook/assets/03 (8).jpg>)

Если увеличить масштаб, становится видно, что параметры XYZ еще не заполнены. Первые два параметра автоматически заполняются данными из Revit.

\![Exercise](<../.gitbook/assets/02 (9).jpg>)

Для ввода этих значений выполним сложную операцию со списком. Сам график довольно прост, но его логика строится на основе сопоставления списков, которое рассматривалось в разделе, посвященном спискам.

\![](<images/6/documenting - exercise III - 04.jpg>)

> 1. Выберите все адаптивные компоненты с двумя узлами.
> 2. Извлеките местоположение каждой точки с помощью узла _AdaptiveComponent.Locations_.
> 3. Преобразуйте эти точки в строки. Следует помнить, что параметр является текстовым, поэтому входные данные должны иметь правильный тип.
> 4. Создайте список из четырех строк, которые определяют изменяемые параметры: _XYZ1, XYZ2, XYZ3_ и _XYZ4_.
> 5. Соедините этот список с портом ввода _parameterName_ узла _Element.SetParameterByName_.
> 6. Соедините узел _Element.SetParameterByName_ с портом ввода _combinator_ узла _List.Combine_. Соедините _адаптивные компоненты_ с портом ввода _list1_. Соедините узел _String from Object_ с портом ввода _list2_.

В данном случае мы сопоставляем списки, так как вводим четыре значения для каждого элемента, что создает сложную структуру данных. Узел _List.Combine_ управляет операцией, выполняемой на один шаг вниз по иерархии данных. Именно поэтому порты ввода element и value узла _Element.SetParameterByName_ остаются пустыми. Вложенные списки входных параметров узла _List.Combine_ соединяются с пустыми портами ввода узла _Element.SetParameterByName_ в соответствии с порядком их подсоединения.

При выборе панели в Revit становится видно, что для каждого параметра есть строковые значения. В реальном проекте для создания точки (X,Y,Z) использовался бы более простой формат. Это можно сделать с помощью строковых операций в Dynamo, но в рамках данного раздела этот метод не рассматривается.

\![](<../.gitbook/assets/04 (5).jpg>)

Вид образца спецификации с заполненными параметрами.

\![](<../.gitbook/assets/01 (9).jpg>)

Каждая панель ETFE теперь имеет координаты XYZ, введенные для каждой адаптивной точки и соответствующие углам каждой изготавливаемой панели.

\![Exercise](<../.gitbook/assets/00 (8).jpg>)
